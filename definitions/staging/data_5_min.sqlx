config {
	type: "view"
}
SELECT
  symbol,
  MAX(price) AS high,
  MIN(price) AS low,
  MAX(timestamp) close,
  MIN(timestamp) open
FROM
  ${ref("staging")}
WHERE
  timestamp > TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 5 MINUTE)
GROUP BY
  symbol
