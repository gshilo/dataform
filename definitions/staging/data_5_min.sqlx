config {
	type: "view",
  dependencies: [ "dataform_staging_assertions_rowConditions" ]
}
SELECT
  symbol,
  MAX(price) AS high,
  MIN(price) AS low,
  MAX(timestamp) close,
  MIN(timestamp) open
FROM
  ${ref("staging")}
WHERE
  timestamp > TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 1 MINUTE)
GROUP BY
  symbol
